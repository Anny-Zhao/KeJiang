<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HPMS Research Group</title>
    <!-- 添加网站图标 -->
    <link rel="icon" type="image/jpeg" href="images/1.jpg">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="header-placeholder"></div> <!-- 公共 HTML 文件占位符 -->
    <div class="container">
        <div class="sidebar">
            <div id="author_bio-placeholder"></div>
        </div>
        <div class="content">
            <h1>Publication Table</h1>
            <table class="card-table">
            <thead>
                <tr>
                <th>Journal</th>
                <th>No. of Publications</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                <td>Thin-Walled Structures</td>
                <td>16</td>
                </tr>
                <tr>
                <td>Engineering Structures</td>
                <td>13</td>
                </tr>
                <tr>
                <td>Journal of Constructional Steel Research</td>
                <td>3</td>
                </tr>
                <tr>
                <td>Journal of Building Engineering</td>
                <td>2</td>
                </tr>
                <tr>
                <td>Total</td>
                <td>36</td>
                </tr>
            </tbody>
            </table>
        
            <!-- Filter Section -->
            <div class="filter">
                <label for="year-filter" class="filter-label">Filter by Year:</label>
                <select id="year-filter" class="filter-select">
                <option value="all">All Years</option>
                </select>
            </div>

            <div class="layered-container">
                <div class="layer">
                    <div class="layer-title">2023</div>
                    <div class="publication-item">
                        <div class="publication-title">Design of High-Strength Steel Connections</div>
                        <div class="publication-details">Journal of Steel Structures, John Doe, Jane Smith</div>
                    </div>
                </div>
                <div class="layer">
                    <div class="layer-title">2022</div>
                    <div class="publication-item">
                        <div class="publication-title">Performance of Aluminium Structures</div>
                        <div class="publication-details">Aluminium Engineering Journal, Alice Brown</div>
                    </div>
                </div>
                <div class="layer">
                    <div class="layer-title">2021</div>
                    <div class="publication-item">
                        <div class="publication-title">Innovative Stainless Steel Members</div>
                        <div class="publication-details">Stainless Innovations, Mark Green</div>
                    </div>
                </div>
            </div>

            <div id="pagination" class="pagination">
                <button id="prev-btn" class="pagination-btn" disabled>←</button>
                <span id="page-info" class="page-info">Page 1 of 1</span>
                <button id="next-btn" class="pagination-btn" disabled>→</button>
              </div>
            </div>
        </div>
    </div>
    <footer>
        <p>High-Performance Metallic Structure (HPMS) Research Group @ University of Canterbury, New Zealand</p>
    </footer>

    <script>
        const itemsPerPage = 5;
        let selectedYear = "all";
        let currentPage = 1;

        const yearFilter = document.getElementById("year-filter");
        const publicationsContainer = document.getElementById("publications");
        const paginationInfo = document.getElementById("page-info");
        const prevBtn = document.getElementById("prev-btn");
        const nextBtn = document.getElementById("next-btn");

        // Populate year filter
        const years = ["all", ...new Set(publications.map((pub) => pub.year))];
        years.forEach((year) => {
        const option = document.createElement("option");
        option.value = year;
        option.textContent = year === "all" ? "All Years" : year;
        yearFilter.appendChild(option);
        });

        // Render publications
        function renderPublications() {
        const filteredPublications =
            selectedYear === "all"
            ? publications
            : publications.filter((pub) => pub.year === parseInt(selectedYear));

        const totalPages = Math.ceil(filteredPublications.length / itemsPerPage);
        const start = (currentPage - 1) * itemsPerPage;
        const end = start + itemsPerPage;

        const currentPublications = filteredPublications.slice(start, end);

        publicationsContainer.innerHTML = "";
        currentPublications.forEach((yearGroup) => {
            const card = document.createElement("div");
            card.className = "card";

            const title = document.createElement("h2");
            title.className = "card-title";
            title.textContent = yearGroup.year;
            card.appendChild(title);

            yearGroup.papers.forEach((paper) => {
            const paperDiv = document.createElement("div");
            paperDiv.className = "card";

            const paperTitle = document.createElement("h3");
            paperTitle.textContent = paper.title;
            paperDiv.appendChild(paperTitle);

            const journal = document.createElement("p");
            journal.className = "card-journal";
            journal.textContent = paper.journal;
            paperDiv.appendChild(journal);

            const authors = document.createElement("p");
            authors.className = "card-authors";
            authors.textContent = paper.authors;
            paperDiv.appendChild(authors);

            card.appendChild(paperDiv);
            });

            publicationsContainer.appendChild(card);
        });

        paginationInfo.textContent = `Page ${currentPage} of ${totalPages}`;
        prevBtn.disabled = currentPage === 1;
        nextBtn.disabled = currentPage === totalPages;
        }

        // Event Listeners
        yearFilter.addEventListener("change", (e) => {
        selectedYear = e.target.value;
        currentPage = 1;
        renderPublications();
        });

        prevBtn.addEventListener("click", () => {
        currentPage = Math.max(currentPage - 1, 1);
        renderPublications();
        });

        nextBtn.addEventListener("click", () => {
        const filteredPublications =
            selectedYear === "all"
            ? publications
            : publications.filter((pub) => pub.year === parseInt(selectedYear));
        const totalPages = Math.ceil(filteredPublications.length / itemsPerPage);
        currentPage = Math.min(currentPage + 1, totalPages);
        renderPublications();
        });

        // Initial render
        renderPublications();

        // 动态加载公共 HTML 文件
        document.addEventListener('DOMContentLoaded', () => {
            // 加载 header.html
            fetch('inputs/header.html')
                .then(response => response.text())
                .then(data => {
                    document.getElementById('header-placeholder').innerHTML = data;
                    
                    // header 加载完成后初始化导航菜单
                    initializeNavigation();
                })
                .catch(error => console.error('加载失败:', error));
    
            // 加载 author_bio.html
            fetch('inputs/author_bio.html')
                .then(response => response.text())
                .then(data => {
                    document.getElementById('author_bio-placeholder').innerHTML = data;
                })
                .catch(error => console.error('加载失败:', error));
        });
    
        // 导航菜单初始化函数
        function initializeNavigation() {
            // 移动端菜单切换
            const menuToggle = document.querySelector('.menu-toggle');
            const nav = document.querySelector('nav');
            if (menuToggle && nav) {
                menuToggle.addEventListener('click', () => {
                    nav.classList.toggle('open');
                });
            }
    
            // Research 下拉菜单
            const dropdownParent = document.querySelector('.has-dropdown');
            if (dropdownParent) {
                // 点击 Research 菜单时的处理
                dropdownParent.addEventListener('click', (event) => {
                    // 只有点击 Research 链接时才切换菜单
                    if (event.target === dropdownParent.querySelector('a')) {
                        event.preventDefault();
                        dropdownParent.classList.toggle('open');
                    }
                });
    
                // 点击页面其他地方时关闭菜单
                document.addEventListener('click', (event) => {
                    if (!dropdownParent.contains(event.target)) {
                        dropdownParent.classList.remove('open');
                    }
                });
    
                // 允许点击下拉菜单中的链接
                const dropdownLinks = dropdownParent.querySelectorAll('.dropdown a');
                dropdownLinks.forEach(link => {
                    link.addEventListener('click', (event) => {
                        event.stopPropagation(); // 阻止事件冒泡
                    });
                });
            }
        }
        </script>
</body>
</html>
